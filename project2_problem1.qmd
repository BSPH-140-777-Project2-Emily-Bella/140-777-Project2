---
title: "Project 2"
author: 
  - name: Emily Potts (epotts@jh.edu / epotts5) and Bella Satpathy-Horton (ghorton2@jh.edu / ghorton2)
    affiliation: Department of Biostatistics, Johns Hopkins
description: "Practicing functional programming and data collection paradigms"
date: 2024-11-15
knitr: true
---

## Aims 

## Data Extraction

```{r}
#|eval: false

library(tidycensus)
library(tidyverse)

census_api_key("7d55de6317ef97afe80c744aab78d1b75e2d1970")

vars1 = c(disability_white = "B18101A_001", disability_black = "B18101B_001", disability_americanindian = "B18101C_001", disability_asian = "B18101D_001", disability_hawaiian = "B18101E_001", disability_otherrace = "B18101F_001", disability_multiracial = "B18101G_001")

vars2 = c(disability_male = "B18101_002", disability_female = "B18101_021", disability_19 = "B18135_003", disability_19_64 = "B18135_014", disability_65plus = "B18135_025")

vars3 = c(disability_medianearning_male = "B18140_003", disability_medianearning_female = "B18140_004", poverty_level_disability = "B23024_003", poverty_level_nodisability = "B23024_010", nodisability_medianearning_male = "B18140_006", nodisability_medianearning_female = "B18140_007")

vars4 = c(disability_allocated = "B99181_002", nodisability_allocated = "B99181_003", employed_disbility = "C18120_004", employed_nodisability = "C18120_005")

vars5 = c(unemployed_disability = "C18120_007", unemployed_nodisability = "C18120_008", notworking_disability = "C18120_010", notworking_nodisability = "C18120_011", total = "B00001_001")

data_1 = get_acs(geography = "tract", year = 2017, variables = vars1, state = "Pennsylvania")
data_2 = get_acs(geography = "tract", year = 2017, variables = vars2, state = "Pennsylvania")
data_3 = get_acs(geography = "tract", year = 2017, variables = vars3, state = "Pennsylvania")
data_4 = get_acs(geography = "tract", year = 2017, variables = vars4, state = "Pennsylvania")
data_5 = get_acs(geography = "tract", year = 2017, variables = vars5, state = "Pennsylvania")
data_6 = get_acs(geography = "tract", year = 2017, variables = c(disability_total = "B18101_001"), state = "Pennsylvania")

data_1 = data_1 %>% 
  pivot_wider(names_from = variable, values_from = c(estimate, moe), names_sep = ".")
data_2 = data_2 %>% 
  pivot_wider(names_from = variable, values_from = c(estimate, moe), names_sep = ".")
data_3 = data_3 %>% 
  pivot_wider(names_from = variable, values_from = c(estimate, moe), names_sep = ".")
data_4 = data_4 %>% 
  pivot_wider(names_from = variable, values_from = c(estimate, moe), names_sep = ".")
data_5 = data_5 %>% 
  pivot_wider(names_from = variable, values_from = c(estimate, moe), names_sep = ".")
data_6 = data_6 %>% 
  pivot_wider(names_from = variable, values_from = c(estimate, moe), names_sep = ".")

data12 = full_join(data_1, data_2, by = c("GEOID", "NAME"))
data126 = full_join(data12, data_6, by = c("GEOID", "NAME"))
data34 = full_join(data_3, data_4, by = c("GEOID", "NAME"))
data345 = full_join(data34, data_5, by = c("GEOID", "NAME"))
data = full_join(data126, data345, by = c("GEOID", "NAME"))

write_csv(data, "project2_data_final2")
```

## Initial Data Visualization

```{r}
library(gtsummary)
data = read_csv("project2_data_final.csv")

data %>% 
  mutate(
    disability.white.percent = estimate.disability.white/estimate.disability_total,
    disability.black.percent = estimate.disability_black/estimate.disability_total,
    disability.americanindian.percent = estimate.disability_americanindian/estimate.disability_total,
    disability.asian.percent = estimate.disability_asian/estimate.disability_total,
    disability.hawaiian.percent = estimate.disability_hawaiian/estimate.disability_total,
    disability.otherrace.percent = estimate.disability_otherrace/estimate.disability_total,
    disability.multiracial.percent = estimate.disability_multiracial/estimate.disability_total,
    disability.male.percent = estimate.disability_male/estimate.disability_total,
    disability.female.percent = estimate.disability_female/estimate.disability_total,
    disability.19.percent = estimate.disability_19/estimate.disability_total,
    disability.1964.percent = estimate.disability_19_64/estimate.disability_total,
    disability.65.percent = estimate.disability_65plus/estimate.disability_total,
    
  )
  
```

